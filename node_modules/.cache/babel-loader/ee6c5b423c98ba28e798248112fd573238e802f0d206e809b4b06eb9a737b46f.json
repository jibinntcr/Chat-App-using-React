{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/JIBIN/Documents/GitHub/Chat-App-using-React/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/JIBIN/Documents/GitHub/Chat-App-using-React/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _objectSpread from\"C:/Users/JIBIN/Documents/GitHub/Chat-App-using-React/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/JIBIN/Documents/GitHub/Chat-App-using-React/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";//import React, { useState, useEffect } from \"react\";\nimport{db,auth}from\"../firebase-config\";import{collection,addDoc,where,serverTimestamp,onSnapshot,query,orderBy}from\"firebase/firestore\";import\"../styles/Chat.css\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";export var Chat=function Chat(_ref){var room=_ref.room;var _useState=useState([]),_useState2=_slicedToArray(_useState,2),messages=_useState2[0],setMessages=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),newMessage=_useState4[0],setNewMessage=_useState4[1];var messagesRef=collection(db,\"messages\");useEffect(function(){var queryMessages=query(messagesRef,where(\"room\",\"==\",room),orderBy(\"createdAt\"));var unsuscribe=onSnapshot(queryMessages,function(snapshot){var messages=[];snapshot.forEach(function(doc){messages.push(_objectSpread(_objectSpread({},doc.data()),{},{id:doc.id}));});console.log(messages);setMessages(messages);});return function(){return unsuscribe();};},[]);var handleSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();if(!(newMessage===\"\")){_context.next=3;break;}return _context.abrupt(\"return\");case 3:_context.next=5;return addDoc(messagesRef,{text:newMessage,createdAt:serverTimestamp(),user:auth.currentUser.displayName,room:room});case 5:setNewMessage(\"\");case 6:case\"end\":return _context.stop();}},_callee);}));return function handleSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"chat-app\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"header\",children:/*#__PURE__*/_jsxs(\"h1\",{children:[\"Welcome to: \",room.toUpperCase()]})}),/*#__PURE__*/_jsx(\"div\",{className:\"messages\",children:messages.map(function(message){return/*#__PURE__*/_jsxs(\"div\",{className:\"message\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"user\",children:[message.user,\":\"]}),\" \",message.text]},message.id);})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"new-message-form\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newMessage,onChange:function onChange(event){return setNewMessage(event.target.value);},className:\"new-message-input\",placeholder:\"Type your message here...\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"send-button\",children:\"Send\"})]})]});};","map":{"version":3,"names":["db","auth","collection","addDoc","where","serverTimestamp","onSnapshot","query","orderBy","Chat","room","useState","messages","setMessages","newMessage","setNewMessage","messagesRef","useEffect","queryMessages","unsuscribe","snapshot","forEach","doc","push","data","id","console","log","handleSubmit","event","preventDefault","text","createdAt","user","currentUser","displayName","toUpperCase","map","message","target","value"],"sources":["C:/Users/JIBIN/Documents/GitHub/Chat-App-using-React/src/components/Chat.js"],"sourcesContent":["\n//import React, { useState, useEffect } from \"react\";\nimport { db, auth } from \"../firebase-config\";\nimport {\n  collection,\n  addDoc,\n  where,\n  serverTimestamp,\n  onSnapshot,\n  query,\n  orderBy,\n} from \"firebase/firestore\";\n\nimport \"../styles/Chat.css\";\n\nexport const Chat = ({ room }) => {\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n  const messagesRef = collection(db, \"messages\");\n\n  useEffect(() => {\n    const queryMessages = query(\n      messagesRef,\n      where(\"room\", \"==\", room),\n      orderBy(\"createdAt\")\n    );\n    const unsuscribe = onSnapshot(queryMessages, (snapshot) => {\n      let messages = [];\n      snapshot.forEach((doc) => {\n        messages.push({ ...doc.data(), id: doc.id });\n      });\n      console.log(messages);\n      setMessages(messages);\n    });\n\n    return () => unsuscribe();\n  }, []);\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n\n    if (newMessage === \"\") return;\n    await addDoc(messagesRef, {\n      text: newMessage,\n      createdAt: serverTimestamp(),\n      user: auth.currentUser.displayName,\n      room,\n    });\n\n    setNewMessage(\"\");\n  };\n\n  return (\n    <div className=\"chat-app\">\n      <div className=\"header\">\n        <h1>Welcome to: {room.toUpperCase()}</h1>\n      </div>\n      <div className=\"messages\">\n        {messages.map((message) => (\n          <div key={message.id} className=\"message\">\n            <span className=\"user\">{message.user}:</span> {message.text}\n          </div>\n        ))}\n      </div>\n      <form onSubmit={handleSubmit} className=\"new-message-form\">\n        <input\n          type=\"text\"\n          value={newMessage}\n          onChange={(event) => setNewMessage(event.target.value)}\n          className=\"new-message-input\"\n          placeholder=\"Type your message here...\"\n        />\n        <button type=\"submit\" className=\"send-button\">\n          Send\n        </button>\n      </form>\n    </div>\n  );\n};\n"],"mappings":"ujBACA;AACA,OAASA,EAAE,CAAEC,IAAI,KAAQ,oBAAoB,CAC7C,OACEC,UAAU,CACVC,MAAM,CACNC,KAAK,CACLC,eAAe,CACfC,UAAU,CACVC,KAAK,CACLC,OAAO,KACF,oBAAoB,CAE3B,MAAO,oBAAoB,CAAC,wFAE5B,MAAO,IAAMC,KAAI,CAAG,QAAPA,KAAI,MAAiB,IAAXC,KAAI,MAAJA,IAAI,CACzB,cAAgCC,QAAQ,CAAC,EAAE,CAAC,wCAArCC,QAAQ,eAAEC,WAAW,eAC5B,eAAoCF,QAAQ,CAAC,EAAE,CAAC,yCAAzCG,UAAU,eAAEC,aAAa,eAChC,GAAMC,YAAW,CAAGd,UAAU,CAACF,EAAE,CAAE,UAAU,CAAC,CAE9CiB,SAAS,CAAC,UAAM,CACd,GAAMC,cAAa,CAAGX,KAAK,CACzBS,WAAW,CACXZ,KAAK,CAAC,MAAM,CAAE,IAAI,CAAEM,IAAI,CAAC,CACzBF,OAAO,CAAC,WAAW,CAAC,CACrB,CACD,GAAMW,WAAU,CAAGb,UAAU,CAACY,aAAa,CAAE,SAACE,QAAQ,CAAK,CACzD,GAAIR,SAAQ,CAAG,EAAE,CACjBQ,QAAQ,CAACC,OAAO,CAAC,SAACC,GAAG,CAAK,CACxBV,QAAQ,CAACW,IAAI,gCAAMD,GAAG,CAACE,IAAI,EAAE,MAAEC,EAAE,CAAEH,GAAG,CAACG,EAAE,GAAG,CAC9C,CAAC,CAAC,CACFC,OAAO,CAACC,GAAG,CAACf,QAAQ,CAAC,CACrBC,WAAW,CAACD,QAAQ,CAAC,CACvB,CAAC,CAAC,CAEF,MAAO,kBAAMO,WAAU,EAAE,GAC3B,CAAC,CAAE,EAAE,CAAC,CAEN,GAAMS,aAAY,6FAAG,iBAAOC,KAAK,mHAC/BA,KAAK,CAACC,cAAc,EAAE,CAAC,KAEnBhB,UAAU,GAAK,EAAE,wFACfX,OAAM,CAACa,WAAW,CAAE,CACxBe,IAAI,CAAEjB,UAAU,CAChBkB,SAAS,CAAE3B,eAAe,EAAE,CAC5B4B,IAAI,CAAEhC,IAAI,CAACiC,WAAW,CAACC,WAAW,CAClCzB,IAAI,CAAJA,IACF,CAAC,CAAC,QAEFK,aAAa,CAAC,EAAE,CAAC,CAAC,qDACnB,kBAZKa,aAAY,6CAYjB,CAED,mBACE,aAAK,SAAS,CAAC,UAAU,wBACvB,YAAK,SAAS,CAAC,QAAQ,uBACrB,sBAAI,cAAY,CAAClB,IAAI,CAAC0B,WAAW,EAAE,GAAM,EACrC,cACN,YAAK,SAAS,CAAC,UAAU,UACtBxB,QAAQ,CAACyB,GAAG,CAAC,SAACC,OAAO,qBACpB,aAAsB,SAAS,CAAC,SAAS,wBACvC,cAAM,SAAS,CAAC,MAAM,WAAEA,OAAO,CAACL,IAAI,CAAC,GAAC,GAAO,IAAC,CAACK,OAAO,CAACP,IAAI,GADnDO,OAAO,CAACb,EAAE,CAEd,EACP,CAAC,EACE,cACN,cAAM,QAAQ,CAAEG,YAAa,CAAC,SAAS,CAAC,kBAAkB,wBACxD,cACE,IAAI,CAAC,MAAM,CACX,KAAK,CAAEd,UAAW,CAClB,QAAQ,CAAE,kBAACe,KAAK,QAAKd,cAAa,CAACc,KAAK,CAACU,MAAM,CAACC,KAAK,CAAC,EAAC,CACvD,SAAS,CAAC,mBAAmB,CAC7B,WAAW,CAAC,2BAA2B,EACvC,cACF,eAAQ,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,aAAa,UAAC,MAE9C,EAAS,GACJ,GACH,CAEV,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}